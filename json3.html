<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>JSON3: Filtering Data</title>
        <meta name="author" content="Kevin Arellano Flores">
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"   
                integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   
                crossorigin="anonymous">
        </script>
    </head>
    <body>
        <script language="javascript">
            var list_categories = [];
            var list_products = [];
            $.get("https://karell19.github.io/cs20_hw07/products.json", 
                function( data ) {
                    var str = JSON.stringify(data);	
                    var list_js = "<ul>";	
                    data.forEach(function(product) {
                        list_products.push(product);

                        for (var i = 0; i < product.categories.length; i++) {
                            if (!list_categories.includes(product.categories[i])) {
                                list_categories.push(product.categories[i]);
                            }
                        }
                    })    

                    var select_filters = document.createElement("select");
                    select_filters.id = "filter_selector";
                    select_filters.addEventListener("click", displayFiltered);
                    for (var i = 0; i < list_categories.length; i++) {
                        var category = document.createElement("option");
                        category.value = list_categories[i];
                        category.innerHTML = list_categories[i];
                        category.id = list_categories[i];
                        select_filters.appendChild(category);
                    }

                    document.getElementById("filters").appendChild(select_filters);
            })

            function displayFiltered() {
                var displayed_div = document.getElementById("categories");
                var list_js = "<ul>";
                for (var i = 0; i < list_products.length; i++) {
                    if (list_products[i]["categories"].includes(this.value)) {
                        list_js += "<li>" + list_products[i]["name"] + "</li><br>";
                    }
                }
                list_js += "</ul>";
                displayed_div.innerHTML = list_js;
            }
        </script>
        <div id="json_string"></div>
        <div id="filters"></div>
        <div id="categories"><br></div>
    </body>
</html>